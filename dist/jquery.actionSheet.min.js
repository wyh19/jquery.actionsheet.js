(function(a){a.fn.ActionSheet=function(f){var g="1.0.2";var j=this;var l=null;if(j.length!=1){r.debug&&console.error("选择器错误，插件无法正常工作");return null}var o;var d;var r=a.extend({debug:false,mode:"list",url:"",data:null,imgBaseUrl:"",imgField:"",labelField:"",idField:"",clickType:"click",backgroundColor:"#333",color:"#fff",callback:null,trggerFirst:false},f);if(!r.data&&r.url==""){r.debug&&console.error("请配置url或data的值");return null}if(r.mode!=""&&r.mode!="grid"&&r.mode!="list"){r.debug&&console.error("请配置正确的mode值");return null}j.css("background-color",r.backgroundColor).css("color",r.color);var m=a('<div class="as-loading"><i>加载中</i></div>');j.addClass("actionSheet");j.append(m);var c=a('<div class="as-bg"></div>');j.parent().append(c);if(r.data){l=r.data;k(r.mode,r.data)}else{u(r.mode,r.url)}function u(w,v){a.ajax({url:v,beforeSend:function(){e()},success:function(y){var x;if(typeof y=="string"){x=a.parseJSON(y)}else{x=y}l=x;k(w,x);h()}})}function k(w,v){if(w=="grid"){q(w,v);n()}else{b(w,v);t()}}function q(w,v){a.each(v,function(x){j.append('<div class="as-grid-cell" data-id="'+v[x][r.idField]+'" data-label="'+v[x][r.labelField]+'"><img class="as-grid-cell-logo" src="'+r.imgBaseUrl+v[x][r.imgField]+'" /><div class="as-grid-cell-label">'+v[x][r.labelField]+"</div></div>")});p(w);n();if(r.trggerFirst){a(".as-grid-cell").first().trigger(r.clickType)}}function n(){o=j.width();var w=parseInt(o/50);var v=parseInt(o/w);a(".as-grid-cell").width(v);a(".as-grid-cell-logo").width(v).height(v);d=j.height();j.css("bottom",-d+"px");c.hide()}function b(w,v){a.each(v,function(x){j.append('<div class="as-list-cell" data-id="'+v[x][r.idField]+'" data-label="'+v[x][r.labelField]+'"><div class="as-list-cell-label">'+v[x][r.labelField]+"</div></div>")});p(w);t()}function t(){o=j.width();d=j.height();j.css("bottom",-d+"px")}function e(){m.show()}function h(){m.hide()}function i(){j.animate({bottom:-d+"px"},300,function(){j.hide();j.parent().css("overflow","auto")});c.hide()}function p(w){if(w=="grid"){a(window).resize(n)}c.on(r.clickType,function(){i()});var v="as-"+w+"-cell";j.on(r.clickType,function(y){var x;if(y.target.className==v){x=a(y.target)}else{if(y.target.parentNode.className==v){x=a(y.target.parentNode)}else{return}}x.addClass("as-"+w+"-cell-active").siblings().removeClass("as-"+w+"-cell-active");r.callback.call(null,x.data("id"),x.data("label"));i()})}var s={show:function(){j.parent().css("overflow","hidden");j.show().animate({bottom:0},300);c.show()},hide:i,reRender:function(){j.empty();k(r.mode,l)},getVersion:function(){console.info("版本号为"+g);return g}};return s}})(jQuery);